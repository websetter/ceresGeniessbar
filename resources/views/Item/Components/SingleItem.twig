{% import "Ceres::Basket.Macros.AddToBasket" as AddToBasket %}

{% set itemData = config("Ceres.item.data") | split(', ') %}
{% set enabledRoutes = config("IO.routing.enabled_routes") | split(', ') %}
{% set shippingCat = config("Ceres.global.shippingCostsCategoryId") %}

<script type="x/template" id="vue-single-item">
    <div>
        <div class="single container-max page-content">
        <div class="row singleKachelmenu">
          <div id="kacheln">
            <div class="row">
                <div v-for="category in categories" class="col-xs-6 col-sm-6 col-md-3">
                    <a v-if="ategory.details[0].image2Path is not empty" href="{{ category.details[0].nameUrl }}">
                        <span class="rabatt">{{ category.details[0].shortDescription | raw }}</span>
                        <img src="/documents/{{category.details[0].image2Path}}" alt="{{ category.details[0].name }}">
                    </a>
                    <a v-else href="{{ category.details[0].nameUrl }}">{{ category.details[0].name }}</a>
                </div>
            </div>
          </div>
        </div>
        <div class="row singleNav">
          <div class="col-xs-12"><span class="toggleMenu">Kategorien anzeigen <span class="fa fa-angle-down"></span></span></div>
          <div class="col-xs-12 col-sm-4"><a href="javascript:window.history.back()" title="zurück"><span class="fa fa-angle-left"></span>Zurück zur Produktübersicht</a></div>
          <div class="col-xs-12 col-sm-4"><add-to-wish-list :variation-id="currentVariation.variation.id"></add-to-wish-list></div>
          <div class="col-xs-12 col-sm-4"><a href="javascript:window.print()" title="drucken"><span class="fa fa-print"></span>Angebot drucken</a></div>
        </div>
            <div class="row">
                <div class="col-md-5 single-leftside">
                    <div class="row">
                        <div class="col-xs-12">
                          <slot name="ImageCarousel"></slot>
                        </div>
                    </div>
                </div>
                <div class="col-md-7 single-rightside">
                  <div class="border">
                  <h1>${ currentVariation | itemName }</h1>
                  <slot name="BeforePrice"></slot>
                  <slot name="AfterPrice"></slot>
                  <p class="articlenumber">
                    <span class="tabStop">{{ trans("Ceres::Template.singleItemNumber") }}: </span><span class="tabStop2">${ currentVariation.variation.number }</span>
                  </p>
                  <p v-if="currentVariation.variation.availability" class="availability">
                    <span class="tabStop">{{ trans("GeniessBar::Template.singleItemAvailability") }}: </span><span class="tabStop2">${ currentVariation.variation.availability.names.name }</span>
                  </p>
                  <p class="articleContent" v-if="currentVariation.unit">
                    <span class="tabStop">{{ trans("Ceres::Template.singleItemContent") }}:</span><span class="tabStop2">${ currentVariation.unit.content | numberFormat } ${ currentVariation.unit.names.name }</span>
                  </p>

                  <!-- Variation -->
                  <div class="variation" v-if="variations.length > 1">
                    <variation-select template="#vue-variation-select" :attributes="attributeNameMap" :variation-units="variationUnits" :variations="variations" :preselect="currentVariation.variation.id" :unitPreselect="currentVariation.variation.unitCombinationId" @is-valid-change="isVariationSelected = $event"></variation-select>
                  </div>
                  <!-- /Variation -->

                  <!-- Item Bundle -->
                    <item-bundle :bundle-type="currentVariation.variation.bundleType" :bundle-components="currentVariation.bundleComponents"></item-bundle>
                  <!-- /Item Bundle -->

                  <div class="row" v-if="currentVariation.filter.isSalable && variationGroupedProperties.length">
                      <order-property-list></order-property-list>
                  </div>



                    <graduated-prices template="#vue-graduated-prices"></graduated-prices>


                    <hr>
                    <div class="prices">
                      <span class="tabStop">Preis: </span>
                      <div class="price">
                        <span ref="variationTotalPrice" :content="currentVariation.prices.default.price.value">
                            ${ variationTotalPrice | currency(currentVariation.prices.default.currency) }
                        </span>
                        <span :content="currentVariation.prices.default.currency"></span>
                      </div>
                        {% if ('item.recommendedPrice' in itemData or 'all' in itemData) %}
                            <div class="crossprice" v-if="currentVariation.prices.rrp && currentVariation.prices.rrp.price.value > 0 && currentVariation.prices.rrp.price.value > currentVariation.prices.default.price.value">
                                <span>
                                    statt ${ currentVariation.prices.rrp.price.formatted }
                                </span>
                            </div>
                        {% endif %}
                        <p class="vat">{{ trans("GeniessBar::Template.singleItemINKL") }}  ${currentVariation.prices.default.vat.value }%<br>{{ trans("GeniessBar::Template.singleItemZZGL") }} <a href="{{ trans("GeniessBar::Template.LinkFooterPaymentAndShipping") }}" target="blank">{{ trans("GeniessBar::Template.singleItemVersand") }}</a></p>
                        <div class="base-price" v-if="currentVariation.unit">
                            <div v-if="currentVariation.variation.mayShowUnitPrice">
                                {{ trans("Ceres::Template.singleItemUnitPrice") }}
                                <span class="base-price-value">
                                    ${ variationGraduatedPrice.basePrice }
                                </span>
                            </div>
                        </div>
                    </div>

                    <hr>
                    <p>Menge:</p>
                    <slot name="BeforeAddToBasket"></slot>

                       {{ AddToBasket.printVueComponent(
                           "currentVariation",
                           false,
                           true,
                           {
                               "v-if": "currentVariation.filter.isSalable",
                               "missing-order-properties":"variationMissingProperties",
                               "is-variation-selected": "isVariationSelected"
                           }
                       ) }}
                       <slot name="AfterAddToBasket"></slot>

                    <slot name="AdditionalContentAfterAddToBasket"></slot>
                    <slot name="AdditionalContentAfterVAT"></slot>
                </div>
                </div>

                <!-- ITEM DESCRIPTION -->
                <div class="col-md-12">
                    <ul class="nav nav-tabs" role="tablist">
                        {% if 'item.description' in itemData or 'all' in itemData %}
                            <li class="nav-item" v-if="isDescriptionTabActive">
                                <a class="nav-link active" data-toggle="tab" :href="'#details-' +  currentVariation.variation.id" role="tab">{{ trans("Ceres::Template.singleItemDescription") }}</a>
                            </li>
                        {% endif %}
                        <li class="nav-item accessoryTab">
                          <a class="nav-link" data-toggle="tab" :href="'#accessory-' +  currentVariation.variation.id" role="tab">Zubehör</a>
                        </li>

                        <slot name="AddDetailTabs"></slot>
                    </ul>

                    <div class="tab-content">
                        {% if 'item.description' in itemData or 'all' in itemData %}
                            <div class="tab-pane active" :id="'details-' + currentVariation.variation.id" role="tabpanel" v-if="isDescriptionTabActive">
                                <div v-html="currentVariation.texts.description">
                                </div>
                            </div>
                        {% endif %}

                        <div :class="{ 'active': !isDescriptionTabActive && !isTechnicalDataTabActive }" class="tab-pane" id="assessments-details" role="tabpanel">
                            <slot name="FeedbackContainer"></slot>
                        </div>
                        <slot name="AddDetailTabsContent"></slot>
                    </div>
                </div>
                <div class="col-xs-12 crossselling">
                  <slot name="ItemListContainer"></slot>
                </div>
            </div>
            <!-- ./ITEM DESCRIPTION -->
        </div>
    </div>
</script>
